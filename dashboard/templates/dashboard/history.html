{% extends 'dashboard/base.html' %}

{% block title %}Query History - SmartSQL Insight{% endblock %}

{% block content %}
<div class="container py-4">
    <h3 class="mb-4">Your Query History</h3>
    {% if queries %}
        <ul class="list-group">
            {% for query in queries %}
                <li class="list-group-item">
                    <strong>NL Query:</strong> {{ query.natural_language }}<br>
                    <strong>SQL:</strong> <code>{{ query.sql_query }}</code><br>
                    <strong>Date:</strong> {{ query.created_at|date:"M d, Y H:i" }}
                    
                    <form method="POST" action="{% url 'dashboard:process_query' %}" class="mt-2">
                        {% csrf_token %}
                        <input type="hidden" name="query" value="{{ query.natural_language }}">
                        <button type="submit" class="btn btn-primary btn-sm">Reprocess</button>
                    </form>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p class="text-muted">No queries found.</p>
    {% endif %}
</div>
{% endblock %}
